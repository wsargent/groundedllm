localhost:443 {
    log {
        output stdout
        level INFO
    }

    tls /etc/caddy/caddy+2.pem /etc/caddy/caddy+2-key.pem
    
    reverse_proxy http://hayhooks:1416 {
        header_up X-Forwarded-For {remote_host}
        header_up X-Real-IP {remote_host}
        header_up X-Forwarded-Proto {scheme}
        
        # Correct health check syntax
        health_uri /status
        health_interval 30s
        health_timeout 5s
        health_passes 1
        health_fails 3
        
        # Handle backend errors
        @backend_error status 5xx 4xx 0
        handle_response @backend_error {
            respond "Backend Error: {upstream.status_code}" {upstream.status_code}
        }
    }
}